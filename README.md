# AssetBERT - èµ„äº§åˆ†ç±»ç³»ç»Ÿ

## ğŸ“œ é¡¹ç›®ç®€ä»‹
æœ¬é¡¹ç›®åŸºäºæ·±åº¦å­¦ä¹ å’Œè§„åˆ™å¼•æ“å®ç°æ–°å›½æ ‡èµ„äº§åˆ†ç±»ä»»åŠ¡ã€‚ç”¨æˆ·è¾“å…¥èµ„äº§åç§°ç­‰ä¿¡æ¯ï¼Œç³»ç»Ÿé€šè¿‡å¤šæ¨¡æ€å¤„ç†æœºåˆ¶è¾“å‡ºæ ‡å‡†åŒ–çš„èµ„äº§åˆ†ç±»ç»“æœã€‚æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š
- ğŸ§  åŸºäºRoBERTaçš„AssetBERTæ¨¡å‹ï¼ˆæ”¯æŒå•å˜é‡/å¤šå˜é‡è¾“å…¥ï¼‰
- âš–ï¸ è§„åˆ™+æ¨¡å‹åŒé˜¶æ®µæ¨ç†å¼•æ“
- ğŸŒ æ”¯æŒAPIæœåŠ¡åŒ–éƒ¨ç½²
- ğŸ“Š å…¨æµç¨‹æ•°æ®å¤„ç†å·¥å…·é“¾

<!-- ## ğŸ“š æ–‡ä»¶åŠŸèƒ½è¯´æ˜

### æ¨¡å‹è®­ç»ƒ
| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½æè¿° |
|---------|---------|
| `train_classifier.py` | å•å˜é‡è¾“å…¥æ¨¡å‹è®­ç»ƒ |
| `train_multi_inputsclassifier.py` | å¤šå˜é‡è¾“å…¥åŸºç¡€æ¨¡å‹è®­ç»ƒ |
| `train_multi_inputsclassifier_advance.py` | å¤šå˜é‡è¾“å…¥å¢å¼ºè®­ç»ƒï¼ˆå«æ–°è®­ç»ƒç­–ç•¥ï¼‰ |
| `train_stacking_deep.py` | ä¸‰æ¨¡å‹é›†æˆå­¦ä¹ è®­ç»ƒï¼ˆå«RWKVã€MLPå’ŒTransformerï¼‰ |
| `train_stacking_gbm.py` | ä¸‰æ¨¡å‹é›†æˆå­¦ä¹ è®­ç»ƒï¼ˆLightGBMæ–¹æ¡ˆï¼‰ |

### æ•°æ®é¢„å¤„ç†
| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½æè¿° |
|---------|---------|
| `split_dataset.py` | è®­ç»ƒé›†/æµ‹è¯•é›†åˆ’åˆ† |
| `process_illegal_char.py` | æ— æ•ˆå­—ç¬¦è½¬æ¢å¤„ç† |
| `extract_colunms.py` | Excelåˆ—æ•°æ®æŠ½å–ï¼ˆè§„åˆ™æ„å»ºï¼‰ |
| `convert_xlsx_data.py` | Excelæ•°æ®æŠ½å–ï¼ˆæ•°æ®é›†æ„å»ºï¼‰ |
| `convert_csv_label.py` | æ ‡ç­¾æ ¼å¼è½¬æ¢ï¼ˆå­—ç¬¦ä¸²â†”æ•°å­—ï¼‰ |
| `data_cleaning.py` | æ•°æ®æ¸…æ´—ä¸»ç¨‹åº |

### æ¨ç†æœåŠ¡
| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½æè¿° |
|---------|---------|
| `infer_service.py` | å•è¾“å…¥è§„åˆ™+æ¨¡å‹æ¨ç† |
| `infer_mi_om_service.py` | çº¯å¤šè¾“å…¥æ¨¡å‹æ¨ç† |
| `infer_mi_om_assemble_service.py` | ä¸‰æ¨¡å‹åŠ æƒæŠ•ç¥¨æ¨ç† |
| `infer_mi_rm_service.py` | è§„åˆ™+å¤šè¾“å…¥æ¨¡å‹æ¨ç† |
| `infer_mi_mr_service.py` | å¤šè¾“å…¥æ¨¡å‹æ¨ç†+è§„åˆ™ |
| `test_assets_vllm.py` | æ¨¡å‹æ€§èƒ½æµ‹è¯•å·¥å…· |

### APIæœåŠ¡
| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½æè¿° |
|---------|---------|
| `api_demo_single.py` | å•è¾“å…¥æ¨¡å‹APIæœåŠ¡ |
| `api_demo.py` | å¤šè¾“å…¥æ¨¡å‹APIæœåŠ¡ |

### å…³é”®èµ„æº
| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½æè¿° |
|---------|---------|
| `rule_æ–°å›½æ ‡åˆ†ç±»æµ‹è¯•é›†.xlsx` | è§„åˆ™åˆ¤æ–­ä¾æ®æ–‡ä»¶ |
| `æ–°å›½æ ‡å›ºå®šèµ„äº§.xlsx` | åŸå§‹åˆ†ç±»æ ‡å‡†å‚è€ƒ |
| `datasets/` | è®­ç»ƒé›†/æµ‹è¯•é›†å­˜å‚¨ç›®å½• |
| `model_output/` | æ¨¡å‹æƒé‡å­˜å‚¨ç›®å½• |
| `train_id2label.json` | æ ‡ç­¾æ˜ å°„é…ç½®æ–‡ä»¶ | -->

## ğŸ—ï¸ é¡¹ç›®ç»“æ„
```bash
AssetBERT/
â”œâ”€â”€ datasets/                # å­˜æ”¾è®­ç»ƒé›†å’Œæµ‹è¯•é›†
â”‚   â”œâ”€â”€ multi_inputs_train.csv
â”‚   â”œâ”€â”€ multi_inputs_dev.csv
â”‚   â””â”€â”€ single_input_train.csv
â”‚       â””â”€â”€ single_input_dev.csv
â”œâ”€â”€ model_output/            # æ¨¡å‹æƒé‡ä¿å­˜ç›®å½•
â”‚   â”œâ”€â”€ multi_inputs/
â”‚   â”‚   â””â”€â”€ [timestamp]/     # æ¯æ¬¡è®­ç»ƒç”Ÿæˆçš„æ—¶é—´æˆ³ç›®å½•
â”‚   â”‚   â””â”€â”€ stacking/        # é›†æˆå­¦ä¹ æ¨¡å‹ä¿å­˜è·¯å¾„
â”‚   â””â”€â”€ single_input/
â”‚       â””â”€â”€ [timestamp]/
â”œâ”€â”€ .gitignore               # å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ api_demo_multi.py        # åŸºäºå¤šè¾“å…¥æ¨¡å‹çš„APIæœåŠ¡ä»£ç 
â”œâ”€â”€ api_demo_single.py       # åŸºäºå•è¾“å…¥æ¨¡å‹çš„APIæœåŠ¡ä»£ç 
â”œâ”€â”€ api_demo.py              # éƒ¨ç½²APIæœåŠ¡çš„ä»£ç ï¼Œæ¨¡å‹+è§„åˆ™è¡¥å……æ–¹æ¡ˆ
â”œâ”€â”€ convert_csv_label.py     # å°†æ•°æ®ä¸­çš„å­—ç¬¦ä¸²æ ‡ç­¾è½¬æ¢ä¸ºæ•°å­—æ ‡ç­¾
â”œâ”€â”€ convert_xlsx_data.py     # åˆ—æ•°æ®æŠ½å–ä»£ç ï¼Œç”¨äºæ„å»ºæ•°æ®é›†
â”œâ”€â”€ data_cleaning.py         # æ•°æ®æ¸…æ´—è„šæœ¬
â”œâ”€â”€ extract_columns.py       # Excel æ–‡ä»¶åˆ—æ•°æ®æŠ½å–ä»£ç 
â”œâ”€â”€ infer_mi_mr_service.py   # å¤šè¾“å…¥ï¼Œæ¨¡å‹+è§„åˆ™è¡¥å……æ¨ç†ä»£ç 
â”œâ”€â”€ infer_mi_rm_service.py   # å¤šè¾“å…¥ï¼Œè§„åˆ™+æ¨¡å‹è¡¥å……æ¨ç†ä»£ç 
â”œâ”€â”€ infer_mi_om_service.py   # å¤šè¾“å…¥æ¨¡å‹æ¨ç†ä»£ç 
â”œâ”€â”€ infer_mi_om_assemble_service.py   # ä¸‰æ¨¡å‹é›†æˆå­¦ä¹ æ¨ç†ä»£ç 
â”œâ”€â”€ infer_service.py         # å•è¾“å…¥è§„åˆ™+æ¨¡å‹æ¨ç†ä»£ç 
â”œâ”€â”€ process_illegal_char.py  # æ— æ•ˆå­—ç¬¦è½¬æ¢ä»£ç 
â”œâ”€â”€ excel_json_processor.py  # æ ¹æ®æ•°æ®é›†åˆ›å»ºæ–°çš„id2labelæ–‡ä»¶
â”œâ”€â”€ rule_æ–°å›½æ ‡åˆ†ç±»æµ‹è¯•é›†.xlsx  # è§„åˆ™åˆ¤æ–­ä¾æ®æ–‡ä»¶
â”œâ”€â”€ rule_all_data_0717.xlsx  # æ ¹æ®æœ€æ–°æ•°æ®æ„å»ºçš„è§„åˆ™åˆ¤æ–­ä¾æ®æ–‡ä»¶
â”œâ”€â”€ split_dataset.py         # åˆ’åˆ†è®­ç»ƒå’Œæµ‹è¯•é›†ä»£ç 
â”œâ”€â”€ test_assets_vilm.py      # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ train_classifier.py       # å•å˜é‡è¾“å…¥æ¨¡å‹è®­ç»ƒæ–‡ä»¶
â”œâ”€â”€ train_multi_inputs_classifier.py  # å¤šå˜é‡è¾“å…¥æ¨¡å‹è®­ç»ƒæ–‡ä»¶
â”œâ”€â”€ train_multi_inputs_classifier_advance.py  # å¸¦æœ‰é«˜çº§è®­ç»ƒç­–ç•¥çš„å¤šå˜é‡è¾“å…¥æ¨¡å‹è®­ç»ƒæ–‡ä»¶
â”œâ”€â”€ train_multi_inputs_classifier_top3.py  # åŠ å…¥ä½¿ç”¨éƒ¨é—¨å­—æ®µï¼Œè¾“å‡ºtop3
â”œâ”€â”€ train_stacking_gbm.py  # åŸºäºLightGBMçš„é›†æˆå­¦ä¹ è®­ç»ƒ
â”œâ”€â”€ train_stacking_deep.py  # åŸºäºæ·±åº¦ç½‘ç»œï¼ˆRWKVã€MLPã€Transformerï¼‰çš„é›†æˆå­¦ä¹ è®­ç»ƒ
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## APIè¯·æ±‚
### å¯åŠ¨å‘½ä»¤ï¼š
```bash
nohup python api_demo.py &
```

### å•é‡è¯·æ±‚
è¯·æ±‚æŒ‡ä»¤ï¼š
```bash
curl -X POST "http://10.120.20.176:20805/predict" -H "Content-Type: application/json" -d '{"èµ„äº§åç§°": "å…­åˆ†é‡å¤©å¹³", "å‹å·": "5N", "ç”¨é€”": "ç§‘ç ”ç”¨", "ä½¿ç”¨éƒ¨é—¨": "ç”Ÿç‰©å¯å‘å·¥ç¨‹ä¸­å¤®å®éªŒå®¤"}'
```
è¾“å‡ºï¼š
```bash
{"code":0,"success":true,"message":"é¢„æµ‹æˆåŠŸ","data":{"top_1":"åˆ†æå¤©å¹³åŠä¸“ç”¨å¤©å¹³","top_3":["åˆ†æå¤©å¹³åŠä¸“ç”¨å¤©å¹³","æµ‹åŠ›ä»ªå™¨","å…¶ä»–æµ·æ´‹ä»ªå™¨è®¾å¤‡"]}}
```

### æ‰¹é‡è¯·æ±‚
è¯·æ±‚æŒ‡ä»¤ï¼š
```bash
curl -X POST "http://10.120.20.176:20805/batch_predict"  -H "Content-Type: application/json"  -d '[
       {
         "èµ„äº§åç§°": "æ˜¾ç¤ºå™¨",
         "å‹å·": "DELL P2422H",
         "ç”¨é€”": "è¡Œæ”¿åŠå…¬ç”¨"
       },
       {
         "èµ„äº§åç§°": "å­¦ä¹ æ¤…",
         "å‹å·": "æ¤…å­1 SHCT5ACH",
         "ç”¨é€”": "åŸ¹è®­æ•™å­¦"
       },
       {
         "èµ„äº§åç§°": "å±é£å·¥ä½",
         "å‹å·": "é•¿æ±Ÿ",
         "ç”¨é€”": "åå‹¤ä¿éšœç”¨"
       }]'
```
è¾“å‡ºï¼š
```bash
{"code":0,"success":true,"message":"æ‰¹é‡é¢„æµ‹æˆåŠŸï¼Œå…±å¤„ç† 3 ä¸ªæ ·æœ¬","data":{"results":[{"top_1":"æ¶²æ™¶æ˜¾ç¤ºå™¨","top_5":["æ¶²æ™¶æ˜¾ç¤ºå™¨","å…¶ä»–åŠå…¬è®¾å¤‡","ç­‰ç¦»å­æ˜¾ç¤ºå™¨","å…¶ä»–ä¿¡æ¯åŒ–è®¾å¤‡","å…¶ä»–è®¡ç®—æœº"]},{"top_1":"æ•™å­¦ã€å®éªŒç”¨æ¡Œ","top_5":["æ•™å­¦ã€å®éªŒç”¨æ¡Œ","æ•™å­¦ä»ªå™¨","è¯•éªŒç®±åŠæ°”å€™ç¯å¢ƒè¯•éªŒè®¾å¤‡","ç›´æµç”µæº","å…¶ä»–å°ã€æ¡Œç±»"]},{"top_1":"åŠå…¬æ¡Œ","top_5":["åŠå…¬æ¡Œ","ç»„åˆå®¶å…·","å…¶ä»–å®¶å…·","ä¼šè®®æ¡Œ","å…¶ä»–å¨å«ç”¨å…·"]}]}}
```

## BERTå˜ä½“æ–‡æœ¬åˆ†ç±»å®éªŒæŠ¥å‘Š
| å®éªŒç¼–å· | æ¨¡å‹åç§°                     | Hugging Face æ¨¡å‹ç‰ˆæœ¬                   | æƒé‡è·¯å¾„                                | è®­ç»ƒç­–ç•¥       | æ¨ç†é€Ÿåº¦ | Top1å‡†ç¡®ç‡ | Top5å‡†ç¡®ç‡ |
|----------|------------------------------|-----------------------------------------|-----------------------------------------|----------------|----------|------------|------------|
| 1        | RoBERTa (baseline)           | `uer/roberta-base-finetuned-chinanews-chinese`           | `/model_output/multi_inputs/2025-07-14-20-21` | æ ‡å‡†è®­ç»ƒ       | æ­£å¸¸     | 0.8885     | 0.9505     |
| 2        | RoBERTa + å¤æ‚ç­–ç•¥           | `uer/roberta-base-finetuned-chinanews-chinese`           | `/model_output/multi_inputs/2025-07-15-13-29` | å¢å¼ºç­–ç•¥       | æ­£å¸¸     | 0.8849     | 0.9544     |
| 3        | **MacBERT**                  | `hfl/chinese-macbert-base`              | `/model_output/multi_inputs/2025-07-15-17-15` | æ ‡å‡†è®­ç»ƒ       | æ­£å¸¸     | 0.8864     | 0.9518     |
| 4        | **ERNIE 3.0**                | `nghuyong/ernie-3.0-base-zh`            | `/model_output/multi_inputs/2025-07-15-17-34` | æ ‡å‡†è®­ç»ƒ       | æ­£å¸¸     | 0.8862     | 0.9493     |
| 5        | **DeBERTa**                  | `KoichiYasuoka/deberta-base-chinese`    | `/model_output/multi_inputs/2025-07-15-17-57` | æ ‡å‡†è®­ç»ƒ       | âš ï¸ **æœ€æ…¢** | 0.8917     | 0.9533     |
| 6        | **WoBERT**                   | `junnyu/wobert_chinese_plus_base`       | `/model_output/multi_inputs/2025-07-15-19-45` | æ ‡å‡†è®­ç»ƒ       | æ­£å¸¸     | 0.8875     | 0.9514     |

## 0717å®éªŒè®°å½•ï¼ˆèµ„äº§åç§°ã€å‹å·ã€ç”¨é€”å’Œä½¿ç”¨éƒ¨é—¨ï¼‰

### å•æ¨¡å‹å®éªŒç»“æœ
| æ¨¡å‹ç±»å‹ | ä¼˜åŒ–æ–¹æ³• | æ¨¡å‹è·¯å¾„ | top1 | top3 | æ€§èƒ½æå‡ |
|----------|----------|----------|-------|-------|----------|
| RoBERTa | æ—  | `/model_output/multi_inputs/2025-07-18-11-12` | 0.9343 | 0.9604 | - |
| RoBERTa | top_kæŸå¤±(æœªè€ƒè™‘åŸå§‹æŸå¤±å’Œæ ‡ç­¾å¹³æ»‘) | `/model_output/multi_inputs/2025-07-18-12-13` | 0.9338 | 0.9617 | âœ“ |
| RoBERTa | top_kæŸå¤±(è€ƒè™‘åŸå§‹æŸå¤±å’Œæ ‡ç­¾å¹³æ»‘) | `/model_output/multi_inputs/2025-07-18-13-29` | - | - | âœ— |
| WoBERT | top_kæŸå¤±(æœªè€ƒè™‘åŸå§‹æŸå¤±å’Œæ ‡ç­¾å¹³æ»‘) | `/model_output/multi_inputs/2025-07-18-14-47` | 0.9330 | 0.9617 | âœ“ |
| MacBERT | top_kæŸå¤±(æœªè€ƒè™‘åŸå§‹æŸå¤±å’Œæ ‡ç­¾å¹³æ»‘) | `/model_output/multi_inputs/2025-07-18-16-32` | 0.9331 | 0.9618 | âœ“ |

### é›†æˆå­¦ä¹ å®éªŒ (RoBERTa+WoBERT+MacBERT)
| é›†æˆæ–¹æ³• | å‚æ•°/æ¨¡å‹ | æ¨¡å‹è·¯å¾„ | top1 | top3 | æå‡å¹…åº¦ |
|----------|-----------|----------|-------|-------|----------|
| åŠ æƒæŠ•ç¥¨ | æƒé‡[0.3,0.3,0.4] | æ—  | 0.9355 | 0.9634 | +0.2% |
| Meta model | MLP | /model_output/multi_inputs/stacking/meta_linear_model.pth | 0.9347 | - | - |
| Meta model | RWKV | /model_output/multi_inputs/stacking/meta_rwkv_model.pth | 0.9267 | - | - |
| Meta model | Transformer | /model_output/multi_inputs/stacking/meta_transformer_model.pth | 0.9314 | - | - |
| Meta model | LightGBM | /model_output/multi_inputs/stacking/lightgbm_model.bin | 0.8838 | - | - |

## æ¨ç†ç­–ç•¥å¯¹æ¯”
è§„åˆ™+æ¨¡å‹è¡¥å……ï¼š
Accuracy@1=0.8934  Accuracy@3=0.9847

æ¨¡å‹+è§„åˆ™è¡¥å……ï¼ˆæ¨¡å‹é˜ˆå€¼0.9æœ€ä¼˜ï¼‰ï¼š
Accuracy@1=0.9541  Accuracy@3=0.9784
